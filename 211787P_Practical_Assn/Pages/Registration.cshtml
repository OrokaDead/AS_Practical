@page
@model _211787P_Practical_Assn.Pages.RegistrationModel
@{
    //var untrustedInput = "<\"123\">";
}

<link rel="stylesheet" href="~/css/register.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
@*
@section Scripts
    {

}
*@
@Html.AntiForgeryToken()

<body>
    <div class="container">
        <div class="title">Registration</div>
        
        <br />
        <div asp-validation-summary="All" class="text-danger"></div>

        <div class="content">

            <form method="post" enctype="multipart/form-data">
                <div class="user-details">

                    <div class="input-box">
                        <label class="details" asp-for="RModel.FullName"></label>
                        <span asp-validation-for="RModel.FullName" class="text-danger"></span>
                        <input type="text" placeholder="enter your full name" asp-for="RModel.FullName">
                    </div>

                    <div class="gender-box">
                        <label class="gender-title" asp-for="RModel.Gender" style="display: block; margin-bottom: 5px; font-weight: 500;"></label>
                        <div class="col-sm-10 d-flex align-items-center">
                            <div class="form-check form-check-inline">
                                @Html.RadioButtonFor(m => m.RModel.Gender, "M", new {@id = "MRadio", Checked = "checked"})
                                <label class="form-check-label" style="padding-left: 3px;">Male</label>
                            </div>
                            <div class="form-check form-check-inline">
                                @Html.RadioButtonFor(m => m.RModel.Gender, "F", new {@id = "FRadio"})
                                <label class="form-check-label" style="padding-left: 3px;">Female</label>
                            </div>
                            <span asp-validation-for="RModel.Gender" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="input-box">
                        <label class="details" asp-for="RModel.MobileNo"></label>
                        <span asp-validation-for="RModel.MobileNo" class="text-danger"></span>
                        <input type="tel" placeholder="enter your Mobile Number" asp-for="RModel.MobileNo"/>
                    </div>

                    <div class="input-box">
                        <label class="details" asp-for="RModel.Email"></label>
                        <span asp-validation-for="RModel.Email" class="text-danger"></span>
                        <input type="email" placeholder="enter email (email must be unique)" asp-for="RModel.Email">
                    </div>

                    <div class="input-box">
                        <label class="details" asp-for="RModel.Password"></label>
                        <span asp-validation-for="RModel.Password" class="text-danger"></span>
                        <input type="password" placeholder="enter password" asp-for="RModel.Password">
                    </div>

                    <div class="input-box">
                        <label class="details" asp-for="RModel.ConfirmPassword"></label>
                        <span asp-validation-for="RModel.ConfirmPassword" class="text-danger"></span>
                        <input type="password" placeholder="confirm password" asp-for="RModel.ConfirmPassword">
                    </div>

                    <div class="input-box">
                        <label class="details" asp-for="RModel.DeliveryAddress"></label>
                        <span asp-validation-for="RModel.DeliveryAddress" class="text-danger"></span>
                        <input type="text" placeholder="enter your delivery address" asp-for="RModel.DeliveryAddress">
                    </div>

                    <div class="input-box">
                        <label class="details" asp-for="RModel.CreditCard"></label>
                        <span asp-validation-for="RModel.CreditCard" class="text-danger"></span>
                        <input type="text" placeholder="enter your credit card number" asp-for="RModel.CreditCard">
                    </div>

                    <div class="input-box-description" style="margin-bottom: 15px;width: calc(100% / 2 - 20px);">
                        <label class="details" asp-for="RModel.AboutMe" style="display: block;font-weight: 500;margin-bottom: 5px;"></label>
                        <span asp-validation-for="RModel.AboutMe" class="text-danger" style="display: block;font-weight: 500; margin-bottom: 5px;"></span>
                        <input type="text" placeholder="enter some information about yourself" asp-for="RModel.AboutMe" style="height: 150px;width: 100%;outline: none;font-size: 16px;border-radius: 5px;padding-left: 15px;border: 1px solid #ccc;border-bottom-width: 2px;transition: all 0.3s ease;" />
                    </div>

                    <div class="img-container" style="margin-bottom: 15px; width: calc(100% / 2 - 20px);">
                        <div class="upload-img" style="padding-bottom: 5px;">
                            <input type="file" accept="image/*" asp-for="Upload" class="form-control" onchange="showImgPreview(this)" />
                            <span asp-validation-for="Upload" class="text-danger"></span>
                        </div>
                        <div class="img" style="padding-left: 140px;">
                            <img id="imgPreview" class="rectangle" style="height:140px;width:215px;object-fit:cover;" />
                        </div>
                    </div>

                    <input type="hidden" id="hdnRecaptcha"><br />
                    <label id="generatedToken"></label>

                    <div class="button">
                        <input type="submit" value="Register" id="btnRegistration">
                    </div>


                </div>
            </form>

        </div>
    </div>
</body>


@*<script src="https://www.google.com/recaptcha/api.js?render=6LfuN1MkAAAAAMzJq158uGNj5xDob80PF8dLVllf"></script>
<script>
    grecaptcha.ready(function () {
        grecaptcha.execute('6LfuN1MkAAAAAMzJq158uGNj5xDob80PF8dLVllf', { action: 'btnRegistration' }).then(function (token) {
            document.getElementById("hdnRecaptcha").value = token;
        });
    });
</script>*@

<script>
    function showImgPreview(input) {
        if (input.files[0]) {
            var uploadimg = new FileReader();
            uploadimg.onload = function (displayimg) { $("#imgPreview").attr('src', displayimg.target.result); }
            uploadimg.readAsDataURL(input.files[0]);
        }
    }
</script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

<script src="https://www.google.com/recaptcha/api.js?render=6LfuN1MkAAAAAMzJq158uGNj5xDob80PF8dLVllf"></script>

    <script type="text/javascript">
    let btnRegister = document.getElementById("btnRegister");

        $(document).ready(function () {

            $(document).on('click', '#btnRegistration', function (e) {
                e.preventDefault();
                grecaptcha.ready(function () {
                grecaptcha.execute('6LfuN1MkAAAAAMzJq158uGNj5xDob80PF8dLVllf', { action: 'index' }).then(function (recaptchaToken) {
                    $('#hdnRecaptcha').val(recaptchaToken);
                    $('#generatedToken').html(recaptchaToken);
                        $.post("/Registration",
                            {
                                //headers: { 'Content-Type': 'application/json' },
                                userName: $("#txtUserName").val(),
                                userEmail: $("#txtUserEmail").val(),
                                password: $("#txtUPassword").val(),
                                confirmPassword: $("#txtUConfirmPassword").val(),
                                reCaptchaToken: $('#hdnRecaptcha').val()
                                    return true;

                            })

                            .done(function (result, status, xyz) {
                                $("#generatedToken").html("Token Result: " + status + " " + recaptchaToken)
                                form.requestSubmit(btnRegister);
                            });

                            .fail(function (result, status, error) {
                                $("#generatedToken").html("Token Result: " + status + " " + error + " " + result.status + " " + result.statusText)
                            });

                    });

                });

            });

        });

    </script>

@*<script>
    function validatePhoneNumber(input_str) {
        var re = /^\(?(\d{3})\)?[- ]?(\d{3})[- ]?(\d{4})$/;

        return re.test(input_str);
    }
</script>*@

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    }